<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel = stylesheet href = estilosListado.css>
<link rel="stylesheet" href="estilosHeaderFooter.css"> 

<script>


function llamada(){
	fetch('../GestionEmpleados?id=0&option=0')
	.then(response => response.json())
	.then(data => pintarDatos(data))
}

function borrar(id){

	if(confirm("seguro que quieres borrar")){
		
    	fetch('../GestionEmpleados?id='+id+'&option=3')
    	.then(response =>  response.json())
    	.then(data => console.log(data))
    	
    	location.reload();

	}
	
	
}

function pintarDatos(datos){
	
	let table = "";
	
	for (let i=0; i<datos.length; i++){
		
		table +=`<tr><td>
		 ${datos[i].id}</td><td>
		 ${datos[i].nombre}</td><td>
		 ${datos[i].email}</td><td>
		 ${datos[i].salario}</td><td>
		 ${datos[i].departamento}</td><td>
		 <a href='editorEmpleados.html?id=${datos[i].id}'>Editar</td><td>
		 <a href="#" onclick="borrar(${datos[i].id})">Borrar</td></tr>`
		
	}
	
	table += "</table>";
	
	document.getElementById("tablaEmpleados").innerHTML = table;
	
}

window.onload = llamada;

</script>

</head>
<body>
<header class="main-header">
    <h1>Gestión de Empleados</h1>
    <p>Bienvenido al sistema de gestión interna</p>
</header>
	<h2>Listado de Empleados</h2>
	 <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Email</th>
                <th>Salario</th>
                <th>Departamento</th>
                <th>Editar</th>
                <th>Borrar</th>
            </tr>
        </thead>
        <tbody id="tablaEmpleados">
            <!-- Aquí se agregarán los empleados -->
        </tbody>
    </table>
    
    <a href="panelPrincipal.html" id="botonMenu">Menú Principal</a>
 
 <footer class="main-footer">
	<button onclick="logout()">Cerrar sesión</button>
    <p>&copy; 2025 - Aplicación desarrollada por Unai Bercianos</p>
</footer>


    <script>
        // Función de logout
        function logout() {
            sessionStorage.removeItem('usuarioLogueado');
            window.location.href = '/EMPLEADOS/gestor/index.html'; // Redirige al login
        }
    </script>
</body>
</html>